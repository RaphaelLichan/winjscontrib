/* 
 * WinJS Contrib v2.1.0.4
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib=WinJSContrib||{};WinJSContrib.WinRT=WinJSContrib.WinRT||{};var __global=this;!function(){"use strict";function r(r,e){for(var n in e)r[n]=e[n]}function e(){var r=Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null),e=Windows.Storage.Streams.DataReader.fromBuffer(r.id),n=new Array(r.id.length);e.readBytes(n);for(var t="",i=0;i<n.length;i++)t+=n[i].toString();return t}function n(){var r=Windows.Networking.Connectivity.NetworkInformation.getConnectionProfiles(),e=r[0].networkAdapter;return e.ianaInterfaceType.toString()}WinJSContrib.WinRT.AppInsight=function(t){var i=this;if(!t||!t.instrumentationKey)throw new Error("you must provide an instrumentationKey "+instrumentationKey);t.endpointUrl=t.endpointUrl||"http://dc.services.visualstudio.com/v2/track",i.options=t,i.tracker=new Microsoft.ApplicationInsights.AppInsights(t);var o=new Windows.ApplicationModel.Resources.Core.ResourceContext,a=window.navigator.language,c=o.qualifierValues.homeRegion,s=o.qualifierValues.deviceFamily,l=Windows.ApplicationModel.Package.current.id.version,p=(Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null),e()),d={"ai.application.ver":l.major+"."+l.minor+"."+l.build+"."+l.revision,"ai.device.type":s,"ai.device.id":p,"ai.device.network":n(),"ai.device.language":a,"ai.user.storeRegion":c};i.tracker.context.addTelemetryInitializer(function(e){r(e.tags,d);var n=e.data.baseData;if(n){var t="Microsoft.ApplicationInsights.",o=null;if(e.name&&0==e.name.indexOf(t)){o=e.name.substr(t.length);var a=i.options.instrumentationKey,c=t+a.replace(/-/g,"")+"."+o;e.name=c}"Exception"===o&&n.exceptions&&n.exceptions.length&&n.exceptions.forEach(function(r){r.id=62619566,r.typeName=r.message})}}),__global.WinJS?WinJS.Application.addEventListener("error",function(r){var e=i.wrapError(r.detail);return e?i.tracker.trackException(e,"Unhandled"):i.tracker.trackException("unknown error","Unhandled",e),i.tracker.flush(),i.onerror?i.onerror(r):void 0}):window.addEventListener("error",function(r,e,n){if(r){var t=r.error;t||(t={message:r.message,stack:r.filename+":"+r.lineno+":"+r.colno}),i.tracker.trackException(i.wrapError(t),"Unhandled"),i.tracker.flush()}}),__global.WinJSContrib&&__global.WinJSContrib.UI&&__global.WinJSContrib.UI.tap&&WinJS.Application.addEventListener("mcn-taperror",function(r){if(!r.error||"Canceled"!=r.error.message){var e=i.wrapError(r.error||r.detail.error);return e?i.tracker.trackException(e,"Unhandled"):i.tracker.trackException("unknown error","Unhandled",r.error||r.detail),i.tracker.flush(),i.ontaperror?i.ontaperror(r):void 0}})},WinJSContrib.WinRT.AppInsight.prototype.wrapError=function(r){if(r){if("[object Error]"===Object.prototype.toString.call(r))return r;var e=r.error;if(e){if("[object Error]"===Object.prototype.toString.call(e))return e;e.error?e=e.error:e.exception&&(e=e.exception)}else if(r.exception){if(e=r.exception,"[object Error]"===Object.prototype.toString.call(e))return e;e.error?e=e.error:e.exception&&(e=e.exception)}if("[object Error]"===Object.prototype.toString.call(e))return e;var n=r;if(r.detail&&(r.detail.message||r.detail.errorMessage)&&(n=r.detail),n.message||n.errorMessage){var t=new Error(n.message||n.errorMessage);return t.stack=n.stack,n.errorUrl&&!n.stack?t.stack=n.errorMessage+" at "+n.errorUrl+":"+n.errorLine+n.errorCharacter:n.filename&&!n.stack&&(t.stack=n.message+" at "+r.filename+":"+r.lineno+":"+r.colno),t}return null}},WinJSContrib.WinRT.AppInsight.prototype.wrapWinJSNavigation=function(r){var e=this;WinJS.Navigation.addEventListener("navigated",function(n){var t=n.detail;e.tracker.trackPageView(null,t.location,r?null:t.state)})}}();