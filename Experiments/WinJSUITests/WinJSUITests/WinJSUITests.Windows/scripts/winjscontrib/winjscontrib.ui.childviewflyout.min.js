/* 
 * WinJS Contrib v2.1.0.6
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

!function(){WinJS.Namespace.define("WinJSContrib.UI",{parentChildView:function(e){for(var n=e.parentNode;n;){if(n.mcnChildnav)return n.winControl;n=n.parentNode}},ChildViewFlyout:WinJS.Class.mix(WinJS.Class.define(function(e,n){e.winControl=this,n=n||{},this.element=e||document.createElement("div"),n.inplace?this.rootElement=this.element:(this.rootElement=document.createElement("div"),this.rootElement.mcnChildnav=!0,this.rootElement.winControl=this,this.element.style.display="none"),document.body.appendChild(this.rootElement),this.navigationEvents=n.navigationEvents,this.element.mcnChildnav=!0,this.element.classList.add("mcn-childview"),this.element.classList.add("win-disposable"),this.rootElement.classList.add("childNavigator"),this.rootElement.classList.add("hidden"),this.element.classList.add("mcn-navigation-ctrl"),this._createContent(n),this.isOpened=!1,this.hardwareBackBtnPressedBinded=this.hardwareBackBtnPressed.bind(this),this.childContentKeyUp=this._childContentKeyUp.bind(this)},{_createContent:function(e){{var n=this,i=WinJSContrib.UI.FluentDOM;new i("DIV")}n.overlay=new i("DIV").addClass("childNavigator-overlay").appendTo(n.rootElement).tap(n.hide.bind(n),{disableAnimation:!0,disableAria:!0}).element,n.contentPlaceholder=new i("DIV","childNavigator-contentPlaceholder",n.rootElement).append("DIV",null,function(e){n.navigator=new WinJSContrib.UI.PageControlNavigator(e.element,{global:!1}),n.navigator.animations.enterPage=WinJS.UI.Animation.fadeIn,n.navigator.hide=function(e){return n.hide(e)}}).element,e&&e.closeBtn&&e.closeBtn.active&&(n.closebtn=new i("DIV","mcn-close-btn",n.contentPlaceholder),e.closeBtn.templatetext&&n.closebtn.html(e.closeBtn.templatetext),e.closeBtn["class"]?n.closebtn.className(n.closebtn.element.className+" "+e.closeBtn["class"]):e.closeBtn.templatetext||n.closebtn.className(n.closebtn.element.className+" default-icon"),WinJSContrib.UI.tap(n.closebtn.element,function(){n.closePage()}))},navigate:function(e,n,i){var t=this;return t.navigator.navigate(e,n)},pageControl:{get:function(){return this.container&&this.container.winControl}},clear:function(e){var n=this;return new WinJS.Promise(function(i,t){WinJS.Promise.wrap(n.closePage(null,null,e)).done(function(){n.navigator.clear(),n.navigator.element.innerText="",n.location=void 0,i()})})},closePage:function(e,n,i){var t=this,a=i?WinJS.Promise.wrap(!0):t.canClose();return a.then(function(i){return i?(1==t.navigator.element.children.length&&t.hide(e,null,!0),t.navigator.triggerPageExit(),t.navigator.closePage(n).then(function(){WinJSContrib.UI.Application.progress&&WinJSContrib.UI.Application.progress.hide()})):WinJS.Promise.wrapError()})},back:function(e){var n=this;return n.navigator.back(e)},canGoBack:function(){return that.navigator.canGoBack},_childContentKeyUp:function(e){"Esc"===e.key&&this.hide()},hardwareBackBtnPressed:function(e){var n=this;n.navigator._checkBackNavigation(e)||(n.hide(),e.handled=!0)},show:function(e){var n=this;return n.isOpened?WinJS.Promise.wrap():(WinJSContrib.UI&&WinJSContrib.UI.enableSystemBackButtonVisibility&&window.Windows&&window.Windows.UI&&window.Windows.UI.Core&&window.Windows.UI.Core.SystemNavigationManager&&(systemNavigationManager=window.Windows.UI.Core.SystemNavigationManager.getForCurrentView(),systemNavigationManager.appViewBackButtonVisibility===window.Windows.UI.Core.AppViewBackButtonVisibility.collapsed&&(systemNavigationManager.appViewBackButtonVisibility=window.Windows.UI.Core.AppViewBackButtonVisibility.visible)),document.body.addEventListener("keyup",n.childContentKeyUp),n.isOpened=!0,this.addDismissableClass("visible"),this.addDismissableClass("enter"),this.removeDismissableClass("leave"),this.removeDismissableClass("hidden"),n.rootElement.getBoundingClientRect(),n.navEventsHandler=WinJSContrib.UI.registerNavigationEvents(n,this.hardwareBackBtnPressedBinded),n.navigationEvents&&n.navigator.addNavigationEvents(),WinJS.Promise.timeout().then(function(){return n.addDismissableClass("enter-active"),WinJSContrib.UI.afterTransition(n.contentPlaceholder).then(function(){n.contentPlaceholder.classList.contains("enter")})}))},addDismissableClass:function(e){var n=this;n.overlay.classList.add(e),n.contentPlaceholder.classList.add(e),n.rootElement.classList.add(e)},removeDismissableClass:function(e){var n=this;n.overlay.classList.remove(e),n.overlay.classList.remove(e+"-active"),n.contentPlaceholder.classList.remove(e),n.contentPlaceholder.classList.remove(e+"-active"),n.rootElement.classList.remove(e),n.rootElement.classList.remove(e+"-active")},pick:function(e,n,i){var t=this;n=n||{},t.pickPromises=t.pickPromises||[];var a=new WinJS.Promise(function(a,s){var r=!1,l=null,c=function(e){o(),l&&l.removeEventListener("closing",c),t.removeEventListener("beforehide",c),r||(r=!0,a({completed:!1,data:null}))};n.navigateStacked=!0,n.injectToPage={close:function(e){o(),r=!0,c(),l&&l.removeEventListener("closing",c),t.removeEventListener("beforehide",c),t.closePage(e,this.rootElement).then(function(){a({completed:!0,data:e})})},cancel:function(){c(),t.closePage()}};var d=JSON.parse(JSON.stringify(n));d.navigateStacked=!0,t.open(e,n,i).then(function(e){l=t.navigator.pageControl,l&&l.addEventListener("closing",c),t.addEventListener("beforehide",c,!1)})}),o=function(){var e=t.pickPromises.indexOf(a);t.pickPromises.splice(e,1)};return t.pickPromises.push(a),a.then(o),a},open:function(e,n,i){var t=this;t.rootElement.classList.add("visible"),t.dispatchEvent("beforeshow");var a=WinJS.Promise.wrap();return t.isOpened||(a=t.show(!0)),WinJS.Promise.join({show:WinJSContrib.UI.afterTransition(t.contentPlaceholder),navigate:t.navigate(e,n,i).done(function(e){t.dispatchEvent("aftershow")})})},canClose:function(){return this.navigator.pageControl&&this.navigator.pageControl.canClose?WinJS.Promise.as(this.navigator.pageControl.canClose()).then(function(e){return e}):WinJS.Promise.wrap(!0)},hide:function(e,n,i){var t=this;if(t.isOpened){var a=i?WinJS.Promise.wrap(!0):t.canClose();a.then(function(n){return t.contentPlaceholder.classList.contains("enter")?(t.addDismissableClass("leave"),n?(t.pickPromises&&t.pickPromises.forEach(function(e){e.cancel()}),document.body.removeEventListener("keyup",t.childContentKeyUp),t.isOpened=!1,t.dispatchEvent("beforehide",e),t.navigator.canGoBack||WinJS.Navigation.canGoBack||WinJSContrib.UI&&WinJSContrib.UI.enableSystemBackButtonVisibility&&window.Windows&&window.Windows.UI&&window.Windows.UI.Core&&window.Windows.UI.Core.SystemNavigationManager&&(systemNavigationManager=window.Windows.UI.Core.SystemNavigationManager.getForCurrentView(),systemNavigationManager.appViewBackButtonVisibility===window.Windows.UI.Core.AppViewBackButtonVisibility.visible&&(systemNavigationManager.appViewBackButtonVisibility=window.Windows.UI.Core.AppViewBackButtonVisibility.collapsed)),t.navEventsHandler&&(t.navEventsHandler(),t.navigator.removeNavigationEvents(),t.navEventsHandler=null),WinJS.Promise.timeout().then(function(){return t.removeDismissableClass("enter"),t.addDismissableClass("leave-active"),WinJS.Promise.join({overlay:WinJSContrib.UI.afterTransition(t.overlay,12e3),content:WinJSContrib.UI.afterTransition(t.contentPlaceholder,12e3)}).then(function(){t.contentPlaceholder.classList.contains("leave")&&(t.clear(!0),t.removeDismissableClass("visible"),t.addDismissableClass("hidden"),t.removeDismissableClass("leave"),t.dispatchEvent("afterhide",e))})})):!1):void 0})}return WinJS.Promise.wrap(!0)},dispose:function(){this.rootElement.winControl=null,WinJS.Utilities.disposeSubTree(this.rootElement),WinJS.Utilities.disposeSubTree(this.element),this.rootElement.parentElement.removeChild(this.rootElement)}}),WinJS.Utilities.eventMixin,WinJS.Utilities.createEventProperties("beforeshow","beforehide","aftershow","afterhide"))})}();