/* 
 * WinJS Contrib v2.0.3.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib;!function(e){var n;!function(n){var t;!function(n){function t(n,t){var i=WinJS.UI.Pages.define(n,t);return e.UI.Pages.fragmentMixin(i),i}function i(n){var t=n.prototype;if(!n.winJSContrib){if(n.winJSContrib=!0,e.UI.Pages.defaultFragmentMixins.forEach(function(e){WinJS.Class.mix(n,e)}),!t.__wLoad){t.__wLoad=t.load,t.load=function(){return WinJS.Promise.as(this.__wLoad.apply(this,arguments)).then(function(e){return t.__wInit||i(t),e})};var i=function(n){n.__wDispose=n.dispose,n.__wInit=n.init,n.__wProcessed=n.processed,n.__wReady=n.ready,n.__wUpdateLayout=n.updateLayout,n.init=function(e){return e.classList.add("mcn-fragment"),e.classList.add("mcn-layout-ctrl"),e.style.display&&(this._initialDisplay=e.style.display),e.style.display="none",this.__wInit.apply(this,arguments)},n.processed=function(n,t){var i=this,o=arguments;return e.UI.bindMembers(n,i),WinJS.Promise.as(i.__wProcessed.apply(i,o)).then(function(){n.style.display=i._initialDisplay||"";n.getBoundingClientRect();return r(i,n,"pageLayout",[n,t],null,i.pageLayout)})},n.ready=function(n,t){var i=this;return e.UI.bindActions(n,this),WinJS.Promise.as(i.__wReady.apply(i,arguments)).then(function(){return i.onafterready?i.onafterready(n,t):void 0}).then(function(){return r(i,n,"pageReady",[n,t])})},n.dispose=function(){e.UI.untapAll(this.element),this.eventTracker&&(this.eventTracker.dispose(),this._eventTracker=null),this.promises&&this.cancelPromises&&(this.cancelPromises(),this._promises=[]),this.__wDispose&&this.__wDispose(this)},n.updateLayout=function(){var e=this,n=arguments,t=WinJS.Promise.wrap();return e.__wUpdateLayout&&(t=WinJS.Promise.as(e.__wUpdateLayout.apply(e,n))),t.then(function(){return r(e,e.element,"updateLayout",n)})}}}return n}}function r(e,n,t,i,r,o){var a=[];r&&a.push(WinJS.Promise.as(r.apply(e,i)));var s=n.querySelectorAll(".mcn-layout-ctrl");if(s&&s.length){for(var u=0,l=s.length;l>u;){var c=s[u];if(c){var m=c.winControl[t];m&&a.push(WinJS.Promise.as(m.apply(c.winControl,i)))}u+=1}return o&&a.push(WinJS.Promise.as(o.apply(e,i))),WinJS.Promise.join(a)}return WinJS.Promise.wrap()}function o(n,t,i,r){function o(n){i&&i.injectToPage&&e.Utils.inject(n,i.injectToPage),n.navigationState={location:t,state:i},r.oncreate&&r.oncreate(n.element,i),r.oninit&&n.elementReady.then(function(){r.oninit(n.element,i)}),r.onrender&&n.renderComplete.then(function(){r.onrender(n.element,i)}),r.onready&&n.renderComplete.then(function(){return n.readyComplete}).then(function(){r.onready(n.element,i)}),(n.enterPageAnimation||r.enterPage)&&(n._enterAnimation=n.enterPageAnimation?n.enterPageAnimation:r.enterPage,n.enterPageAnimation=function(){var e=this,n=null;return u.style.opacity="",n=e&&e.getAnimationElements?e.getAnimationElements(!1):e.element,n?e._enterAnimation(n):void 0}),r.closeOldPagePromise&&(n._beforelayoutPromise=r.closeOldPagePromise,n.onbeforelayout=function(){return this._beforelayoutPromise}),n.beforeShow||(n.beforeShow=[]),n.contentReadyComplete=n.renderComplete.then(function(){return e.UI.disableAutoResources?void 0:WinJS.Resources.processAll(u)}).then(function(){return n.elementReady}).then(function(){return c}).then(function(){return n.beforeShow.length?e.Promise.parallel(n.beforeShow,function(e){return WinJS.Promise.as(e())}):void 0}).then(function(){return n.enterPageAnimation?WinJS.Promise.as(n.enterPageAnimation(u,r)):void(n.element.style.opacity="")}).then(a,s)}var a,s;r=r||{};var u=document.createElement("div");u.setAttribute("dir",window.getComputedStyle(u,null).direction),u.style.opacity="0",n.appendChild(u);var l=new WinJS.Promise(function(e,n){a=e,s=n}),c=r.parented?WinJS.Promise.as(r.parented):null,m=WinJS.UI.Pages.get(t);return e.UI.Pages.fragmentMixin(m),setImmediate(function(){new m(u,i,o,c)}),l}n.defaultFragmentMixins=[{$:function(e){return this.element?$(e,this.element||this._element):void 0},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var n=this.element.querySelectorAll(e);return n&&!n.forEach&&(n=[].slice.call(n)),n}},eventTracker:{get:function(){return this._eventTracker||(this._eventTracker=new e.UI.EventTracker),this._eventTracker}},promises:{get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises)for(var n=0;n<e.promises.length;n++)e.promises[n]&&e.promises[n].cancel()}}],n.define=t,n.fragmentMixin=i,n.renderFragment=o}(t=n.Pages||(n.Pages={}))}(n=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));