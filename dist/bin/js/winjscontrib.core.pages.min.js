/* 
 * WinJS Contrib v2.1.0.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var __global=this,profiler=__global.msWriteProfilerMark||function(){},WinJSContrib;!function(e){var n;!function(n){var t;!function(n){function t(e,n,t,i,r,o){var s=[];r&&s.push(WinJS.Promise.as(r.apply(e,i)));var a=n.querySelectorAll(".mcn-layout-ctrl");if(a&&a.length){for(var u=0,l=a.length;l>u;){var c=a[u];if(c){var p=c.winControl[t];p&&s.push(WinJS.Promise.as(p.apply(c.winControl,i)))}u+=1}return o&&s.push(WinJS.Promise.as(o.apply(e,i))),WinJS.Promise.join(s)}return WinJS.Promise.wrap()}function i(n,t,i,r){function o(n){i&&i.injectToPage&&e.Utils.inject(n,i.injectToPage),n.navigationState={location:t,state:i},r.oncreate&&r.oncreate(n.element,i),r.oninit&&n.elementReady.then(function(){r.oninit(n.element,i)}),(n.enterPageAnimation||r.enterPage)&&(n._enterAnimation=n.enterPageAnimation?n.enterPageAnimation:r.enterPage,n.enterPageAnimation=function(){var e=this,n=null;return u.style.opacity="",n=e&&e.getAnimationElements?e.getAnimationElements(!1):e.element,n?e._enterAnimation(n):void 0}),n.contentReadyComplete=n.renderComplete.then(function(){return r.onrender&&r.onrender(n.element,i),e.UI.disableAutoResources?void 0:WinJS.Resources.processAll(u)}),n.readyComplete.then(function(){return r.closeOldPagePromise?r.closeOldPagePromise:void 0}).then(function(){return r.onready&&r.onready(n.element,i),n.enterPageAnimation?WinJS.Promise.as(n.enterPageAnimation(u,r)):void(n.element.style.opacity="")}).then(s,a)}var s,a;r=r||{};var u=document.createElement("div");u.setAttribute("dir",__global.getComputedStyle(u,null).direction),u.style.opacity="0",n.appendChild(u);{var l=new WinJS.Promise(function(e,n){s=e,a=n}),c=r.parented?WinJS.Promise.as(r.parented):null,p=WinJS.UI.Pages.get(t);new p(u,i,o,c)}return l}n.defaultFragmentMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var n=this.element.querySelectorAll(e);return n&&!n.forEach&&(n=[].slice.call(n)),n}}},{dispose:function(){this._promises&&(this.cancelPromises(),this._promises=null)},promises:{configurable:!0,get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises)for(var n=0;n<e.promises.length;n++)e.promises[n]&&e.promises[n].cancel()}},{dispose:function(){this._eventTracker&&(this._eventTracker.dispose(),this._eventTracker=null)},eventTracker:{configurable:!0,get:function(){return this._eventTracker||(this._eventTracker=new e.UI.EventTracker),this._eventTracker}}}],n.renderFragment=i;var r=function(){function e(e,n,t){var i=this;this.queue=[],this.isDone=!1,this.stepName=n,this.promise=new WinJS.Promise(function(e,n){i._resolvePromise=e,i._rejectPromise=n}),e.promises.push(this.promise),t&&t.pageLifeCycle.steps[n].attach(function(){return i.promise})}return e.prototype.attach=function(e){return this.queue&&!this.isDone?(this.queue.push(e),this.promise):WinJS.Promise.as(e())},e.prototype.resolve=function(e){var n=this;this.isDone=!0;var t=[];return this.queue&&this.queue.length&&(this.queue.forEach(function(e){t.push(new WinJS.Promise(function(n,t){try{WinJS.Promise.as(e()).then(function(e){n(e)},t)}catch(i){t(i)}}))}),this.queue=null),WinJS.Promise.join(t).then(function(){return n._resolvePromise(e),n.promise},this.reject.bind(this))},e.prototype.reject=function(e){return this.isDone=!0,this.queue=null,this._rejectPromise(e),WinJS.Promise.wrapError(this.promise)},e}();n.PageLifeCycleStep=r,function(n,i,o,s,a,u,l,c,p,f){"use strict";function h(e){var n=i.document.createElement("a");return n.href=e,n.href}function d(e){return i.document.location.href.toLowerCase()===e.toLowerCase()}function m(e,n){var t=e.prototype.dispose;return e=o.Class.mix(e,n),t&&n.hasOwnProperty("dispose")&&(e.prototype.dispose=function(){t.apply(this),n.dispose.apply(this)}),e}function y(e,n){return n?(n.__proto__.hasOwnProperty("hasOwnProperty")||y(e,n.__proto__),m(e,n)):e}function g(e,n){return n?"function"==typeof n?(e.prototype._attachedConstructors||(e.prototype._attachedConstructors=[]),e.prototype._attachedConstructors.push(n),y(e,n.prototype)):"object"==typeof n?m(e,n):e:e}function v(n,i,r,o,s,u){r.style.display&&(n.pageLifeCycle.initialDisplay=r.style.display),r.style.display="none";var p=" uri='"+i+"'"+a._getProfilerMarkIdentifier(n.element);l("WinJS.UI.Pages:createPage"+p+",StartTM"),e.UI.WebComponents&&(n.observer=e.UI.WebComponents.watch(n.element));var f=c.timeout().then(function(){return n.load(i)}),h=f.then(function(e){return n._attachedConstructors&&n._attachedConstructors.forEach(function(e){e.apply(n,[r,o])}),c.join({loadResult:e,initResult:n.init(r,o)})}).then(function(e){return n.pageLifeCycle.steps.init.resolve().then(function(){return e})}).then(function(e){return n.render(r,o,e.loadResult)}).then(function(){return n.pageLifeCycle.steps.render.resolve()});n.elementReady=h.then(function(){return r}),n.renderComplete=h.then(function(){return n.process(r,o)}).then(function(){return e.UI.WebComponents?WinJS.Promise.timeout():void 0}).then(function(){return n.pageLifeCycle.steps.process.resolve()}).then(function(){return e.UI.bindMembers(r,n),n.processed(r,o)}).then(function(){return n});var d=function(){s&&s(n),l("WinJS.UI.Pages:createPage"+p+",StopTM")};n.renderComplete.then(d,d),n.layoutComplete=n.renderComplete.then(function(){return u}).then(function(){r.style.display=n.pageLifeCycle.initialDisplay||"";r.getBoundingClientRect();return t(n,r,"pageLayout",[r,o],null,n.pageLayout)}).then(function(){e.UI.bindActions(r,n)}).then(function(){return n.pageLifeCycle.steps.layout.resolve()}).then(function(){return n}),n.readyComplete=n.layoutComplete.then(function(){n.ready(r,o),n.pageLifeCycle.ended=new Date,n.pageLifeCycle.delta=n.pageLifeCycle.ended-n.pageLifeCycle.created,console.log("navigation to "+i+" took "+n.pageLifeCycle.delta+"ms"),t(n,r,"pageReady",[r,o])}).then(function(){return n.pageLifeCycle.steps.ready.resolve()}).then(function(){return n}).then(null,function(e){return n.error?n.error(e):void 0}),n.__checkLayout=function(){var e=this,n=arguments,i=null;return i=e.updateLayout?WinJS.Promise.as(e.updateLayout.apply(e,n)):WinJS.Promise.wrap(),i.then(function(){return t(e,e.element,"updateLayout",n)})}}function C(n,t){var s=h(n).toLowerCase(),a=J[s];return n=h(n),a||(a=o.Class.define(function(t,o,s,a){var l=this,c=e.Utils.getScopeControl(t);u.addClass(t,"win-disposable"),u.addClass(t,"pagecontrol"),u.addClass(t,"mcn-layout-ctrl"),l.pageLifeCycle={created:new Date,location:n,stop:function(){l.readyComplete.cancel(),l.cancelPromises()},steps:{init:new r(l,"init",null),render:new r(l,"render",null),process:new r(l,"process",c),layout:new r(l,"layout",c),ready:new r(l,"ready",c)},initialDisplay:null},this._disposed=!1,this.element=t=t||i.document.createElement("div"),t.msSourceLocation=n,this.uri=n,this.selfhost=d(n),t.winControl=this,l.parentedComplete=a,v(this,n,t,o,s,a)},w),a=o.Class.mix(a,WinJS.UI.DOMEventMixin),e.UI.Pages.defaultFragmentMixins.forEach(function(e){m(a,e)}),J[s]=a),a=g(a,t),a.selfhost=d(n),a}function P(e,n){var t=J[e];return t||(t=C(e)),n&&(t=g(t,n)),t.selfhost&&WinJS.Utilities.ready(function(){_(h(e),i.document.body)},!0),t}function _(e,n,t,i){var r=s.get(e),o=new r(n,t,null,i);return o.renderComplete.then(null,function(e){return c.wrapError({error:e,page:o})})}function S(e){var n=J[e];return n||(n=P(e)),n}function W(e){p.clearCache(h(e)),delete J[e.toLowerCase()]}if(i.document&&s){var J=s._viewMap||{},w={dispose:function(){this._disposed||(this._disposed=!0,this.readyComplete.cancel(),u.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:p.renderCopy(h(e))},process:function(e){return f.processAll(e)},processed:function(){},render:function(e,n,t){return this.selfhost||e.appendChild(t),e},ready:function(){}};n._corePages={get:s.get,render:s.render,define:s.define,_remove:s._remove,_viewMap:s._viewMap};var L={define:P,get:S,render:_,_remove:W,_viewMap:J},U=WinJS.UI.Pages;WinJS.Namespace._moduleDefine(n,null,L),U.get=L.get,U.define=L.define,U.render=L.render,U._remove=L._remove,WinJS.UI.HtmlControl=WinJS.Class.define(function(e,n,t){WinJS.UI.Pages.render(n.uri,e,n).then(t,function(){t()})})}}(e.UI.Pages,__global,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,profiler,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI)}(t=n.Pages||(n.Pages={}))}(n=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));