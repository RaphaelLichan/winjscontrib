/* 
 * WinJS Contrib v2.1.0.4
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib=WinJSContrib||{};WinJSContrib.WinRT=WinJSContrib.WinRT||{};var __global=this;!function(){"use strict";function r(r,e){for(var t in e)r[t]=e[t]}function e(){var r=Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null),e=Windows.Storage.Streams.DataReader.fromBuffer(r.id),t=new Array(r.id.length);e.readBytes(t);for(var n="",i=0;i<t.length;i++)n+=t[i].toString();return n}function t(){var r=Windows.Networking.Connectivity.NetworkInformation.getConnectionProfiles(),e=r[0].networkAdapter;return e.ianaInterfaceType.toString()}WinJSContrib.WinRT.AppInsight=function(n){var i=this;if(!n||!n.instrumentationKey)throw new Error("you must provide an instrumentationKey "+instrumentationKey);n.endpointUrl=n.endpointUrl||"http://dc.services.visualstudio.com/v2/track",i.options=n,i.tracker=new Microsoft.ApplicationInsights.AppInsights(n);var o=new Windows.ApplicationModel.Resources.Core.ResourceContext,a=window.navigator.language,c=o.qualifierValues.homeRegion,s=o.qualifierValues.deviceFamily,l=Windows.ApplicationModel.Package.current.id.version,p=(Windows.System.Profile.HardwareIdentification.getPackageSpecificToken(null),e()),d={"ai.application.ver":l.major+"."+l.minor+"."+l.build+"."+l.revision,"ai.device.type":s,"ai.device.id":p,"ai.device.network":t(),"ai.device.language":a,"ai.user.storeRegion":c};i.tracker.context.addTelemetryInitializer(function(e){r(e.tags,d);var t=e.data.baseData;if(t){var n="Microsoft.ApplicationInsights.",o=null;if(e.name&&0==e.name.indexOf(n)){o=e.name.substr(n.length);var a=i.options.instrumentationKey,c=n+a.replace(/-/g,"")+"."+o;e.name=c}"Exception"===o&&t.exceptions&&t.exceptions.length&&t.exceptions.forEach(function(r){r.id=62619566,r.typeName=r.message})}}),__global.WinJS?WinJS.Application.addEventListener("error",function(r){r.detail.setPromise(WinJS.Promise.timeout(5e3));var e=i.wrapError(r.detail);return e?i.tracker.trackException(e,"Unhandled"):i.tracker.trackException("unknown error","Unhandled",e),i.tracker.flush(),i.onerror?i.onerror(r):void 0}):window.addEventListener("error",function(r,e,t){if(r){var n=r.error;n||(n={message:r.message,stack:r.filename+":"+r.lineno+":"+r.colno}),i.tracker.trackException(i.wrapError(n),"Unhandled"),i.tracker.flush()}}),__global.WinJSContrib&&__global.WinJSContrib.UI&&__global.WinJSContrib.UI.tap&&WinJS.Application.addEventListener("mcn-taperror",function(r){if(!r.error||"Canceled"!=r.error.message){var e=i.wrapError(r.error||r.detail.error);return e?i.tracker.trackException(e,"Unhandled tap error"):i.tracker.trackException("unknown tap error","Unhandled tap error",r.error||r.detail),i.tracker.flush(),i.ontaperror?i.ontaperror(r):void 0}})},WinJSContrib.WinRT.AppInsight.prototype.wrapError=function(r){if(r){if("[object Error]"===Object.prototype.toString.call(r))return r;var e=r.error;if(e){if("[object Error]"===Object.prototype.toString.call(e))return e;e.error?e=e.error:e.exception&&(e=e.exception)}else if(r.exception){if(e=r.exception,"[object Error]"===Object.prototype.toString.call(e))return e;e.error?e=e.error:e.exception&&(e=e.exception)}if("[object Error]"===Object.prototype.toString.call(e))return e;var t=r;if(r.detail&&(r.detail.message||r.detail.errorMessage)&&(t=r.detail),t.message||t.errorMessage){var n=new Error(t.message||t.errorMessage);return n.stack=t.stack,t.errorUrl&&!t.stack?n.stack=t.errorMessage+" at "+t.errorUrl+":"+t.errorLine+t.errorCharacter:t.filename&&!t.stack&&(n.stack=t.message+" at "+r.filename+":"+r.lineno+":"+r.colno),n}return null}},WinJSContrib.WinRT.AppInsight.prototype.wrapWinJSNavigation=function(r){var e=this;WinJS.Navigation.addEventListener("navigated",function(t){var n=t.detail;e.tracker.trackPageView(null,n.location,r?null:n.state)})}}();