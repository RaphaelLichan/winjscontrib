/* 
 * WinJS Contrib v2.0.1.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var WinJSContrib=WinJSContrib||{};WinJSContrib.UI=WinJSContrib.UI||{},WinJSContrib.UI.Pages=WinJSContrib.UI.Pages||{},function(e,t,n,r,i,o,s,a,u,c){"use strict";function l(e){var n=t.document.createElement("a");return n.href=e,n.href}function h(e){return t.document.location.href.toLowerCase()===e.toLowerCase()}function f(e,t){return t?(t.__proto__.hasOwnProperty("hasOwnProperty")||f(e,t.__proto__),n.Class.mix(e,t)):e}function d(e,t){return t?"function"==typeof t?(e.prototype._attachedConstructors||(e.prototype._attachedConstructors=[]),e.prototype._attachedConstructors.push(t),f(e,t.prototype)):"object"==typeof t?n.Class.mix(e,t):e:e}function p(r,u){var c=l(r).toLowerCase(),f=S[c];return r=l(r),f||(f=n.Class.define(function(e,n,u,c){var l=this;this._disposed=!1,this.element=e=e||t.document.createElement("div"),o.addClass(e,"win-disposable"),e.msSourceLocation=r,this.uri=r,this.selfhost=h(r),e.winControl=this,o.addClass(e,"pagecontrol");var f=" uri='"+r+"'"+i._getProfilerMarkIdentifier(this.element);s("WinJS.UI.Pages:createPage"+f+",StartTM");var d=a.timeout().then(function(){return l.load(r)}),p=d.then(function(t){return l._attachedConstructors&&l._attachedConstructors.forEach(function(t){t.apply(l,[e,n])}),a.join({loadResult:t,initResult:l.init(e,n)})}).then(function(t){return l.render(e,n,t.loadResult)});this.elementReady=p.then(function(){return e}),this.renderComplete=p.then(function(){return l.process(e,n)}).then(function(){return l.processed(e,n)}).then(function(){return WinJSContrib.UI.bindMembers(e,l),WinJSContrib.UI.bindActions(e,l),l});var m=function(){u&&u(l),s("WinJS.UI.Pages:createPage"+f+",StopTM")};this.renderComplete.then(m,m),this.readyComplete=this.renderComplete.then(function(){return c}).then(function(){return l.ready(e,n),l}).then(null,function(e){return l.error?l.error(e):void 0})},g),f=n.Class.mix(f,WinJS.UI.DOMEventMixin),f.winJSContrib=!0,e.defaultPageMixins.forEach(function(e){var t=f.prototype.dispose;f=n.Class.mix(f,e),t&&e.hasOwnProperty("dispose")&&(f.prototype.dispose=function(){t.apply(this),e.dispose.apply(this)})}),S[c]=f),f=d(f,u),f.selfhost=h(r),f}function m(e,n){var r=S[e];return r||(r=p(e)),n&&(r=d(r,n)),r.selfhost&&WinJS.Utilities.ready(function(){v(l(e),t.document.body)},!0),r}function v(e,t,n,i){var o=r.get(e),s=new o(t,n,null,i);return s.renderComplete.then(null,function(e){return a.wrapError({error:e,page:s})})}function _(e){var t=S[e];return t||(t=m(e)),t}function C(e){u.clearCache(l(e)),delete S[e.toLowerCase()]}var S=r._viewMap||{};e.defaultPageMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var t=this.element.querySelectorAll(e);t&&!t.forEach&&(t.forEach=function(e){for(var n=0;n<t.length;n++)e(t[n],n)})}}},{dispose:function(){this._promises&&(this.cancelPromises(),this._promises=null)},promises:{configurable:!0,get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises)for(var t=0;t<e.promises.length;t++)e.promises[t]&&e.promises[t].cancel()}},{dispose:function(){this._eventTracker&&(this._eventTracker.dispose(),this._eventTracker=null)},eventTracker:{configurable:!0,get:function(){return this._eventTracker||(this._eventTracker=new WinJSContrib.UI.EventTracker),this._eventTracker}}}];var g={dispose:function(){this._disposed||(this._disposed=!0,o.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:u.renderCopy(l(e))},process:function(e){return c.processAll(e)},processed:function(){},render:function(e,t,n){return this.selfhost||e.appendChild(n),e},ready:function(){}};e._corePages={get:r.get,render:r.render,define:r.define,_remove:r._remove,_viewMap:r._viewMap};var J={define:m,get:_,render:v,_remove:C,_viewMap:S};WinJS.Namespace._moduleDefine(e,null,J),WinJS.UI.Pages.get=J.get,WinJS.UI.Pages.define=J.define,WinJS.UI.Pages.render=J.render,WinJS.UI.Pages._remove=J._remove}(WinJSContrib.UI.Pages,window,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,msWriteProfilerMark,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI);