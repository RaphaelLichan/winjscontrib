/* 
 * WinJS Contrib v2.0.3.0
 * licensed under MIT license (see http://opensource.org/licenses/MIT)
 * sources available at https://github.com/gleborgne/winjscontrib
 */

var profiler=window.msWriteProfilerMark||function(){},WinJSContrib;!function(e){var t;!function(t){var n;!function(t){!function(n,r,i,o,s,a,u,c,l,p){"use strict";function f(e){var t=r.document.createElement("a");return t.href=e,t.href}function d(e){return r.document.location.href.toLowerCase()===e.toLowerCase()}function h(e,t){return t?(t.__proto__.hasOwnProperty("hasOwnProperty")||h(e,t.__proto__),i.Class.mix(e,t)):e}function m(e,t){return t?"function"==typeof t?(e.prototype._attachedConstructors||(e.prototype._attachedConstructors=[]),e.prototype._attachedConstructors.push(t),h(e,t.prototype)):"object"==typeof t?i.Class.mix(e,t):e:e}function y(n,r,i,o,a,l){i.style.display&&(n.pageLifeCycle.initialDisplay=i.style.display),i.style.display="none";var p=" uri='"+r+"'"+s._getProfilerMarkIdentifier(n.element);u("WinJS.UI.Pages:createPage"+p+",StartTM"),e.UI.WebComponents&&(n.observer=e.UI.WebComponents.watch(n.element));var f=c.timeout().then(function(){return n.load(r)}),d=f.then(function(e){return n._attachedConstructors&&n._attachedConstructors.forEach(function(e){e.apply(n,[i,o])}),c.join({loadResult:e,initResult:n.init(i,o)})}).then(function(e){return n.render(i,o,e.loadResult)}).then(function(){return e.UI.WebComponents?WinJS.Promise.timeout():void 0});n.elementReady=d.then(function(){return i}),n.renderComplete=d.then(function(){if(n.pageLifeCycle.processQueue&&n.pageLifeCycle.processQueue.length){var e=[];return n._pageLifeCycle.processQueue.forEach(function(e){return WinJS.Promise.as(e())}),WinJS.Promise.join(e).then(function(){n._pageLifeCycle.processQueue=null})}}).then(function(){return n.process(i,o)}).then(function(){return e.UI.bindMembers(i,n),n.processed(i,o)});var h=function(){a&&a(n),u("WinJS.UI.Pages:createPage"+p+",StopTM")};n.renderComplete.then(h,h),n.readyComplete=n.renderComplete.then(function(){return l}).then(function(){i.style.display=n.pageLifeCycle.initialDisplay||"";i.getBoundingClientRect();return e.UI.Pages.broadcast(n,i,"pageLayout",[i,o],null,n.pageLayout)}).then(function(){e.UI.bindActions(i,n)}).then(function(){return n.ready(i,o),n.pageLifeCycle.ended=new Date,n.pageLifeCycle.delta=n.pageLifeCycle.ended-n.pageLifeCycle.created,console.log("navigation to "+r+" took "+n.pageLifeCycle.delta+"ms"),e.UI.Pages.broadcast(n,i,"pageReady",[i,o])}).then(null,function(e){return n.error?n.error(e):void 0}),n.__checkLayout=function(){var e=this,n=arguments,r=null;return r=e.updateLayout?WinJS.Promise.as(e.updateLayout.apply(e,n)):WinJS.Promise.wrap(),r.then(function(){return t.broadcast(e,e.element,"updateLayout",n)})}}function g(t,o){var s=f(t).toLowerCase(),u=S[s];return t=f(t),u||(u=i.Class.define(function(e,n,i,o){var s=this;s.pageLifeCycle={created:new Date,location:t,processQueue:[],initialDisplay:null},this._disposed=!1,this.element=e=e||r.document.createElement("div"),e.msSourceLocation=t,this.uri=t,this.selfhost=d(t),e.winControl=this,s.parentedComplete=o,a.addClass(e,"win-disposable"),a.addClass(e,"pagecontrol"),a.addClass(e,"mcn-layout-ctrl"),y(this,t,e,n,i,o)},W),u=i.Class.mix(u,WinJS.UI.DOMEventMixin),n.defaultPageMixins.forEach(function(e){var t=u.prototype.dispose;u=i.Class.mix(u,e),t&&e.hasOwnProperty("dispose")&&(u.prototype.dispose=function(){t.apply(this),e.dispose.apply(this)})}),e.UI.Pages.fragmentMixin(u),S[s]=u),u=m(u,o),u.selfhost=d(t),u}function C(e,t){var n=S[e];return n||(n=g(e)),t&&(n=m(n,t)),n.selfhost&&WinJS.Utilities.ready(function(){v(f(e),r.document.body)},!0),n}function v(e,t,n,r){var i=o.get(e),s=new i(t,n,null,r);return s.renderComplete.then(null,function(e){return c.wrapError({error:e,page:s})})}function _(e){var t=S[e];return t||(t=C(e)),t}function P(e){l.clearCache(f(e)),delete S[e.toLowerCase()]}var S=o._viewMap||{};n.defaultPageMixins=[{$:function(e){return $(e,this.element||this._element)},q:function(e){return this.element?this.element.querySelector(e):void 0},qAll:function(e){if(this.element){var t=this.element.querySelectorAll(e);return t&&!t.forEach&&(t=[].slice.call(t)),t}}},{dispose:function(){this._promises&&(this.cancelPromises(),this._promises=null)},promises:{configurable:!0,get:function(){return this._promises||(this._promises=[]),this._promises}},addPromise:function(e){return this.promises.push(e),e},cancelPromises:function(){var e=this;if(e.promises)for(var t=0;t<e.promises.length;t++)e.promises[t]&&e.promises[t].cancel()}},{dispose:function(){this._eventTracker&&(this._eventTracker.dispose(),this._eventTracker=null)},eventTracker:{configurable:!0,get:function(){return this._eventTracker||(this._eventTracker=new e.UI.EventTracker),this._eventTracker}}}];var W={dispose:function(){this._disposed||(this._disposed=!0,this.readyComplete.cancel(),a.disposeSubTree(this.element),this.element=null)},init:function(){},load:function(e){return this.selfhost?void 0:l.renderCopy(f(e))},process:function(e){return p.processAll(e)},processed:function(){},render:function(e,t,n){return this.selfhost||e.appendChild(n),e},ready:function(){}};n._corePages={get:o.get,render:o.render,define:o.define,_remove:o._remove,_viewMap:o._viewMap};var w={define:C,get:_,render:v,_remove:P,_viewMap:S},L=WinJS.UI.Pages;WinJS.Namespace._moduleDefine(n,null,w),L.get=w.get,L.define=w.define,L.render=w.render,L._remove=w._remove}(e.UI.Pages,window,WinJS,WinJS.UI.Pages,WinJS.Utilities,WinJS.Utilities,profiler,WinJS.Promise,WinJS.UI.Fragments,WinJS.UI)}(n=t.Pages||(t.Pages={}))}(t=e.UI||(e.UI={}))}(WinJSContrib||(WinJSContrib={}));